var C=Object.defineProperty,_=Object.defineProperties;var k=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var v=(n,t,a)=>t in n?C(n,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[t]=a,g=(n,t)=>{for(var a in t||(t={}))I.call(t,a)&&v(n,a,t[a]);if(x)for(var a of x(t))S.call(t,a)&&v(n,a,t[a]);return n},b=(n,t)=>_(n,k(t));import{r as c,b as f,p as U,t as E,j as e,P as A,a as i,u as L,F as O,B as j,c as N,_ as P,d as B,R as F,e as M}from"./vendor.b011e5e1.js";const R=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function a(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(r){if(r.ep)return;r.ep=!0;const s=a(r);fetch(r.href,s)}};R();function V(){return c.exports.createElement("svg",{viewBox:"0 0 288 288",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},c.exports.createElement("linearGradient",{id:"a",gradientUnits:"userSpaceOnUse",x1:76.81,x2:211.16,y1:211.17,y2:76.81},c.exports.createElement("stop",{offset:.21,stopColor:"#fff"}),c.exports.createElement("stop",{offset:.42,stopColor:"#fff",stopOpacity:0}),c.exports.createElement("stop",{offset:.59,stopColor:"#fff",stopOpacity:0}),c.exports.createElement("stop",{offset:.81,stopColor:"#fff"})),c.exports.createElement("path",{d:"m88.46 216a16.45 16.45 0 0 0 12.46-5.71l112.56-130.57a16.42 16.42 0 0 0 -13.94-7.72 16.46 16.46 0 0 0 -12.41 5.65l-113.13 129.8a16.46 16.46 0 0 0 14.46 8.55z",fill:"url(#a)"}),c.exports.createElement("path",{d:"m88.46 216a16.46 16.46 0 0 0 7.54-1.83v-109l87.45 104.94a16.44 16.44 0 0 0 12.64 5.89h3.45a16.46 16.46 0 0 0 16.46-16.46v-111.08a16.46 16.46 0 0 0 -16.46-16.46 16.36 16.36 0 0 0 -7.54 1.81v109.05l-87.45-104.94a16.44 16.44 0 0 0 -12.64-5.92h-3.45a16.46 16.46 0 0 0 -16.46 16.46v111.08a16.46 16.46 0 0 0 16.46 16.46z",fill:"#fff"}))}const T="development",p="challenge-7.vladkens.testnet";function $(n){switch(n){case"production":case"mainnet":return{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:p,walletUrl:"https://wallet.near.org",helperUrl:"https://helper.mainnet.near.org",explorerUrl:"https://explorer.mainnet.near.org"};case"development":case"testnet":return{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:p,walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org",explorerUrl:"https://explorer.testnet.near.org"};case"betanet":return{networkId:"betanet",nodeUrl:"https://rpc.betanet.near.org",contractName:p,walletUrl:"https://wallet.betanet.near.org",helperUrl:"https://helper.betanet.near.org",explorerUrl:"https://explorer.betanet.near.org"};case"local":return{networkId:"local",nodeUrl:"http://localhost:3030",keyPath:`${{}.HOME}/.near/validator_key.json`,walletUrl:"http://localhost:4000/wallet",contractName:p};case"test":case"ci":return{networkId:"shared-test",nodeUrl:"https://rpc.ci-testnet.near.org",contractName:p,masterAccount:"test.near"};case"ci-betanet":return{networkId:"shared-test-staging",nodeUrl:"https://rpc.ci-betanet.near.org",contractName:p,masterAccount:"test.near"};default:throw Error(`Unconfigured environment '${n}'. Can be configured in src/config.js.`)}}const m=$(T);console.log(m);async function D(n=[],t=[]){const a=await f.connect(g({deps:{keyStore:new f.keyStores.BrowserLocalStorageKeyStore}},m)),l=new f.WalletConnection(a,null),r=await new f.Contract(l.account(),m.contractName,{viewMethods:n,changeMethods:t}),s=l.getAccountId();window.walletConnection=l,window.contract=r,window.accountId=s}function G(){window.walletConnection.requestSignIn(m.contractName)}function H(){window.walletConnection.signOut(),window.location.replace(window.location.origin+window.location.pathname)}const w={async get_view_state(){return await window.contract.get_view_state({account_id:window.accountId})},async get_candidates(){const n=await window.contract.get_candidates(),t={};for(let a of n)t[a[0]]=a[1].votes;return t},async vote(n){return window.contract.vote({candidate:n}).then(t=>t,t=>null)},async add_candidate(n){return window.contract.add_candidate({candidate:n}).then(t=>!0,t=>!1)}},W=()=>e("div",{className:"hero min-h-screen bg-base-200",children:e("div",{className:"text-center hero-content",children:i("div",{className:"max-w-lg",children:[i("h1",{className:"mb-5 text-5xl font-bold",children:["Welcome to",e("br",{}),e("a",{href:"https://twitter.com/hashtag/NEARvember",target:"_blank",className:"text-red-400 rounded px-1 hover:underline",children:"#NEARvember"}),"!"]}),i("p",{className:"mb-5 text-2xl",children:["This is Challenge 8 app.",e("br",{}),"You can suggest & vote for the next US President!"]}),e("button",{className:"btn btn-primary",onClick:G,children:"Get Started"})]})})}),q=({onClick:n})=>{const[t,a]=c.exports.useState(!1),[l,r]=c.exports.useState(""),s=async()=>{const d=l.trim();d.length!==0&&(a(!0),await n(d),r(""),a(!1))};return e("div",{className:"form-control",children:i("div",{className:"relative",children:[e("input",{type:"text",placeholder:"Name",className:"w-full pr-16 input input-primary input-bordered",onChange:d=>r(d.target.value),value:l}),e("button",{className:N("absolute top-0 right-0 rounded-l-none btn btn-primary",t?"loading":""),onClick:s,children:"add"})]})})},z=({children:n,onClick:t})=>{const[a,l]=c.exports.useState(!1),[r,s]=c.exports.useState(!1),d=async()=>{s(!1),l(!0),await t(),s(!0),l(!1)},o={angle:90,spread:126,startVelocity:15,elementCount:37,dragFriction:.12,duration:2100,stagger:3,width:"7px",height:"7px",perspective:"498px",colors:["#f00","#0f0","#00f"]};return i("button",{className:N("btn btn-accent btn-sm",a?"loading":""),onClick:d,children:[e(P,{active:r,config:o}),n]})},K=()=>{const[n,t]=c.exports.useState([]),a=L();c.exports.useEffect(()=>{let o=!0;const u=async()=>{const y=await w.get_view_state();o&&t(y)};let h=setInterval(u,5e3);return u(),()=>{clearInterval(h),o=!1}},[]);const l=async o=>{if(await w.vote(o)===null){a.show(`You already voted for ${o}!`);return}for(let h of n)h.candidate===o&&(h.votes+=1);t([...n])},r=async o=>{if(!await w.add_candidate(o)){a.show(`Candidate "${o}" already in elections list!`);return}await w.get_view_state().then(t)},s=o=>{let u={1:"\u{1F947}",2:"\u{1F948}",3:"\u{1F949}"};return o in u?e("span",{className:"text-3xl leading-none",children:u[o]}):o.toString()},d=n.sort((o,u)=>u.votes-o.votes);return i("div",{children:[i("div",{className:"navbar mb-2 shadow-lg bg-neutral text-neutral-content flex justify-between items-center text-lg",children:[i("div",{children:[e("div",{className:"w-12 h-12 mr-2",children:e(V,{})}),"Hi,\xA0",e("span",{className:"font-bold",children:window.accountId}),"!"]}),e("div",{className:"",children:e("button",{className:"btn btn-link text-white ml-2",onClick:H,children:"Logout"})})]}),e("div",{className:"flex flex-col justify-center items-center my-5",children:i("div",{className:"w-full max-w-2xl",children:[i("table",{className:"table w-full",children:[e("thead",{children:i("tr",{children:[e("th",{className:"text-center",children:"Place"}),e("th",{className:"text-center",children:"Candidate"}),e("th",{className:"text-center",children:"Votes"}),e("th",{className:"md:w-48"})]})}),e(O,{className:"table-row-group",children:d.map((o,u)=>i("tr",{className:"bg-base-100 even:bg-base-200",children:[e("th",{className:"text-center font-normal",children:s(u+1)}),e("td",{className:"text-center",children:o.candidate}),e("td",{className:"text-center font-bold",children:o.votes}),e("td",{className:"flex justify-center md:w-48",children:o.can_vote?e(z,{onClick:()=>l(o.candidate),children:"Vote!"}):"\u2705"})]},o.candidate))})]}),i("div",{className:"w-full mt-12 mb-20 px-5",children:[e("p",{className:"text-center text-xl my-3",children:"Don't like any of the candidates? Add your own:"}),e(q,{onClick:r})]})]})})]})},Y=({style:n,message:t,close:a})=>i("div",{className:"alert alert-error justify-start",style:n,children:[e(j,{className:"w-6 mr-2"}),e("label",{children:t})]}),X=()=>{const n={position:U.TOP_RIGHT,timeout:5e3,transition:E.SCALE,offset:"76px 10px"};return e(A,b(g({template:Y},n),{children:e(c.exports.Suspense,{fallback:"Loading...",children:window.walletConnection.isSignedIn()?e(K,{}):e(W,{})})}))};window.Buffer=B.Buffer;const J=async()=>{await D(["get_candidates","get_view_state"],["vote","add_candidate"]),F.render(e(M.StrictMode,{children:e(X,{})}),document.getElementById("root"))};J();
